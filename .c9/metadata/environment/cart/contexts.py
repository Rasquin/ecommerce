{"filter":false,"title":"contexts.py","tooltip":"/cart/contexts.py","undoManager":{"mark":18,"position":18,"stack":[[{"start":{"row":0,"column":0},"end":{"row":21,"column":85},"action":"insert","lines":["from django.shortcuts import get_object_or_404","from products.models import Product","","","def cart_contents(request):","    \"\"\"","    Ensures that the cart contents are available when rendering","    every page","    \"\"\"","    cart = request.session.get('cart', {})","","    cart_items = []","    total = 0","    product_count = 0","    ","    for id, quantity in cart.items():","        product = get_object_or_404(Product, pk=id)","        total += quantity * product.price","        product_count += quantity","        cart_items.append({'id': id, 'quantity': quantity, 'product': product})","    ","    return {'cart_items': cart_items, 'total': total, 'product_count': product_count}"],"id":1}],[{"start":{"row":2,"column":0},"end":{"row":3,"column":0},"action":"insert","lines":["",""],"id":2}],[{"start":{"row":3,"column":0},"end":{"row":3,"column":2},"action":"insert","lines":["\"\""],"id":3}],[{"start":{"row":3,"column":2},"end":{"row":3,"column":3},"action":"insert","lines":["\""],"id":4}],[{"start":{"row":3,"column":3},"end":{"row":4,"column":0},"action":"insert","lines":["",""],"id":5}],[{"start":{"row":4,"column":0},"end":{"row":4,"column":2},"action":"insert","lines":["\"\""],"id":6}],[{"start":{"row":4,"column":2},"end":{"row":4,"column":3},"action":"insert","lines":["\""],"id":7}],[{"start":{"row":3,"column":3},"end":{"row":4,"column":0},"action":"insert","lines":["",""],"id":8}],[{"start":{"row":4,"column":0},"end":{"row":9,"column":46},"action":"insert","lines":["Unlike the products app, where we created a model which then puts products into our database, in this case, the cart items will not go into the database.","They will just be stored in the session when the user is logged in.","So a user can add products to their cart, but when they log out, that cart will be lost.","So this is a little bit different from what we've done before.","So you can see there, we've had to import our product from our products.models.","And we create a method called cart_contents()."],"id":9}],[{"start":{"row":4,"column":131},"end":{"row":4,"column":132},"action":"remove","lines":[" "],"id":10}],[{"start":{"row":4,"column":131},"end":{"row":4,"column":132},"action":"insert","lines":[" "],"id":11}],[{"start":{"row":15,"column":14},"end":{"row":16,"column":0},"action":"insert","lines":["",""],"id":12},{"start":{"row":16,"column":0},"end":{"row":16,"column":4},"action":"insert","lines":["    "]},{"start":{"row":16,"column":4},"end":{"row":17,"column":0},"action":"insert","lines":["",""]},{"start":{"row":17,"column":0},"end":{"row":17,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":17,"column":4},"end":{"row":17,"column":107},"action":"insert","lines":["allow anything that's added to the cart to be available for display on any web page within the web app."],"id":13}],[{"start":{"row":18,"column":7},"end":{"row":19,"column":0},"action":"insert","lines":["",""],"id":14},{"start":{"row":19,"column":0},"end":{"row":19,"column":4},"action":"insert","lines":["    "]},{"start":{"row":19,"column":4},"end":{"row":20,"column":0},"action":"insert","lines":["",""]},{"start":{"row":20,"column":0},"end":{"row":20,"column":4},"action":"insert","lines":["    "]},{"start":{"row":20,"column":4},"end":{"row":20,"column":5},"action":"insert","lines":["#"]}],[{"start":{"row":20,"column":5},"end":{"row":20,"column":92},"action":"insert","lines":["So it requests the existing cart if there is one, or a blank dictionary if there's not."],"id":15}],[{"start":{"row":20,"column":8},"end":{"row":20,"column":9},"action":"remove","lines":["i"],"id":16}],[{"start":{"row":20,"column":8},"end":{"row":20,"column":9},"action":"insert","lines":["I"],"id":17}],[{"start":{"row":20,"column":7},"end":{"row":20,"column":8},"action":"remove","lines":[" "],"id":18}],[{"start":{"row":20,"column":6},"end":{"row":20,"column":7},"action":"remove","lines":["o"],"id":19},{"start":{"row":20,"column":5},"end":{"row":20,"column":6},"action":"remove","lines":["S"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":7,"column":43},"end":{"row":7,"column":43},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":true,"wrapToView":true},"firstLineState":0},"timestamp":1568968817279,"hash":"7443f9ff13bef79f5202a688c7edeb4e84980346"}